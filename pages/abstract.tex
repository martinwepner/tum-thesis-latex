\chapter{\abstractname}
Simulating incompressible fluids requires numerically solving the Navier-Stokes equations. An integral part of many commonly used methods achieving this is solving a system of linear equations to obtain the pressure. 
\par In recent years, many machine learning and optimization methods involving fluids have been proposed, ranging from learned approximations of fluid behavior to optimal control. $\Phi_{Flow}$ is a fully differentiable fluid simulation toolkit based on the machine learning framework TensorFlow. This enables both classical optimization of simulation properties as well as the training of neural networks which predict inputs or control parameters of a simulation. Its pressure solver is implemented in TensorFlow and thus capable of running on CPUs and GPUs. However, TensorFlow's dataflow graph causes considerable computational overhead, which slows down the simulation and hence the training of neural networks, especially on the GPU. 
\par This thesis addresses this performance problem by presenting a TensorFlow custom op that solves the pressure efficiently on GPUs. A tailored version of the widely used compressed sparse row matrix format is introduced, which efficiently stores the Laplace matrix of the pressure to minimize memory access. 
\par My solution outperforms $\Phi_{Flow}$'s native TensorFlow implementation by a factor of up to two orders of magnitudes compared to the CPU version and is up to 70 times faster than the GPU version on my test environment while producing the same results.